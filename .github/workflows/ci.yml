name: CI

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.11"

    - name: Install dependencies
      run: pip install pyyaml

    - name: Test script syntax
      run: |
        python -m py_compile scripts/run_experiment
        python -m py_compile scripts/add_tool
        python -m py_compile scripts/snapshot_experiment

    - name: Check required files
      run: |
        test -f configs/meta.yaml
        test -f scripts/run_experiment
        test -f scripts/add_tool
        test -f scripts/snapshot_experiment
        test -f CLAUDE.md
        test -f README.md

    - name: Validate meta.yaml structure
      run: |
        python -c "
import yaml
with open('configs/meta.yaml') as f:
    meta = yaml.safe_load(f)
assert 'tools' in meta, 'Missing tools section'
assert 'experiment' in meta, 'Missing experiment section'
print('meta.yaml structure OK')
"
